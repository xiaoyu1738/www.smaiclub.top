name = "chat-worker"
main = "src/index.js"
compatibility_date = "2025-12-14"

# 路由配置
routes = [
	{ pattern = "chat.smaiclub.top", custom_domain = true }
]

# Durable Objects 配置
[durable_objects]
bindings = [
  { name = "CHAT_ROOM", class_name = "ChatRoom" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatRoom"]

# Chat Database
[[d1_databases]]
binding = "CHAT_DB"
database_name = "prod-chat-db"
database_id = "2b3109cb-9d56-4262-984d-c2a2eb38156c"

# 注意：用户认证现在通过调用 login.smaiclub.top/api/me 接口实现
# 不再需要 USER_DB 绑定和 SECRET_KEY

# Cleanup Cron
[triggers]
crons = ["*/15 * * * *"] # Every 15 minutes
